{%- assign birthSexRawValue = '' -%}
{%- assign birthSexNullFlavor = '' -%}
{%- if birthSObs and birthSObs.value -%}
    {%- assign birthSexRawValue = birthSObs.value.code | default: birthSObs.value.displayName | default: birthSObs.value.originalText._ | default: '' | strip -%}
    {%- assign birthSexNullFlavor = birthSObs.value.nullFlavor | default: birthSObs.nullFlavor | default: '' | upcase | strip -%}
{%- endif -%}
{%- assign normalizedBirthSex = birthSexRawValue | downcase | strip -%}
{%- if normalizedBirthSex == 'm' or normalizedBirthSex == 'male' -%}
    {%- assign normalizedBirthSex = 'M' -%}
{%- elsif normalizedBirthSex == 'f' or normalizedBirthSex == 'female' -%}
    {%- assign normalizedBirthSex = 'F' -%}
{%- elsif normalizedBirthSex == 'u' or normalizedBirthSex == 'unk' or normalizedBirthSex == 'unknown' -%}
    {%- assign normalizedBirthSex = 'UNK' -%}
{%- else -%}
    {%- assign normalizedBirthSex = '' -%}
{%- endif -%}
{%- assign dataAbsentNullFlavor = birthSexNullFlavor | default: 'UNK' -%}
"url": "http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex",
{%- if normalizedBirthSex != '' -%}
    "valueCode": "{{ normalizedBirthSex }}"
{%- else -%}
    "valueCode": "UNK"
{%- endif -%}
