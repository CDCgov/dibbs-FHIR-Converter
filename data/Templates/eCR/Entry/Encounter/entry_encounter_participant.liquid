{% if participant.typeCode == 'LOC' -%}
    {% assign templateIdString = participant.participantRole.templateId | to_json_string -%}
    {% if templateIdString contains '"2.16.840.1.113883.10.20.22.4.32"'-%}
        {% comment %} If location has same ID as encompassing encounter facility, don't create Location resource (duplicate) {% endcomment %}
        {% if participant.participantRole.id.root != facilityId.root or participant.participantRole.id.extension != facilityId.extension %}
            {% assign locationId = participant.participantRole | to_json_string | generate_uuid -%}
            {% include 'Resource/Location' location: participant.participantRole, ID: locationId -%}
            {% assign fullLocationId = locationId | prepend: 'Location/' -%}
            {% include 'Reference/Encounter/Location_Location' ID: encounterId, REF: fullLocationId -%}
        {% endif %}
    {% endif -%}
{% endif -%}